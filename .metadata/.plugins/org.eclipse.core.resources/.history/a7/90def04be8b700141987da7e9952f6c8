package game;

import java.util.ArrayList;
import java.util.Iterator;

import game.Block.BlockType;

public class GameBoard {
	
	public Block[][] gameBoard;
	public Block goal;
	
	public GameBoard(int size) {
		this.gameBoard = new Block[size][size];
		
		for (int i = 0; i < this.gameBoard.length; i++) {
			for (int j = 0; j < this.gameBoard[i].length; j++) {
				BlockType type = getBlockType(i,j);
				this.gameBoard[i][j] = new Block(this, type, i, j);
				if (type == BlockType.GOAL) {
					goal = this.gameBoard[i][j];
				}
				
			}
		}
	}
	
	public boolean canMoveBlock(Block block, int byX, int byY) {
		if (byX < -1 || byX > 1 || byY < -1 || byY > 1) {
			return false;
		}
		
		int newX = block.x + byX;
		int newY = block.y + byY;
		if (newX < 0 || newX > this.gameBoard.length || newY < 0 || newY > this.gameBoard.length) {
			return false;
		}
		
		Block newBlock = getBlock(newX, newY);
		if (.blockType != BlockType.EMPTY)
	}
	
	public Block getBlock(int x, int y) {
		return this.gameBoard[y][x];
	}
	
	public void printGameBoard() {
		for (int i = 0; i < this.gameBoard.length; i++) {
			for (int j = 0; j < this.gameBoard[i].length; j++) {
				Block block = this.gameBoard[i][j];
				block.printBlock();
			}
			System.out.print('\n');
		}
	}
	
	private BlockType getBlockType(int i, int j) 
	{
		ArrayList<int[]> startPos = getPlayerStartPos();
		ArrayList<int[]> walls = getWalls(false);
		int []pos = new int[]{i,j};
		
		if (listContainsPos(startPos, pos)) {
			return BlockType.PLAYER;
		} else if (listContainsPos(walls, pos)) {
			return BlockType.WALL;
		} else if (i == 3 && j == 3) {
			return BlockType.GOAL;
		} else {
			return BlockType.EMPTY;
		}
	}
	
	// Helper Methods
	
	private ArrayList<int[]> getPlayerStartPos() 
	{
		ArrayList<int[]> players = new ArrayList<int[]>();
		players.add(new int[]{0,0});
		players.add(new int[]{this.gameBoard.length - 1,0});
		players.add(new int[]{0,this.gameBoard.length - 1});
		players.add(new int[]{this.gameBoard.length - 1,this.gameBoard.length - 1});
		return players;
	}

	private ArrayList<int[]> getWalls(boolean specialGame) 
	{
		ArrayList<int[]> walls = new ArrayList<int[]>();
		walls.add(new int[]{0,3});
		walls.add(new int[]{1,1});
		walls.add(new int[]{1,4});
		walls.add(new int[]{2,1});
		walls.add(new int[]{2,4});
		walls.add(new int[]{3,1});
		walls.add(new int[]{3,2});
		walls.add(new int[]{3,4});
		walls.add(new int[]{4,2});
		walls.add(new int[]{5,2});
		walls.add(new int[]{5,3});
		walls.add(new int[]{5,4});
		if (specialGame) {
			walls.add(new int[]{6,5});
		}
		return walls;
	}
	
	private boolean listContainsPos(ArrayList<int[]> list, int [] array) {
		boolean isContained = false;
		Iterator<int[]> iterator = list.iterator();
		while(iterator.hasNext() && !isContained) {
			int []compare = iterator.next();
			isContained = array[0] == compare[0] && array[1] == compare[1];
		}
		return isContained;
		
	}

}
